name: Testing

on:
  workflow_dispatch:  
  
env:
  VERSION: 2.0.${{ github.run_number }}
        
jobs: 
  Release:    
    runs-on: windows-latest

    steps:
    - uses: actions/checkout@v2
    
    - name: Setup .NET Core
      uses: actions/setup-dotnet@v1
      with:
          dotnet-version: 3.1.101
          
    - name: Restore
      run: |
        dotnet nuget update source github --username USERNAME --password ${{ secrets.GITHUB_TOKEN }} --store-password-in-clear-text
        dotnet restore Strawhenge.Builder
          
    - name: Build
      run: dotnet build Strawhenge.Builder -p:Version=${{ env.VERSION }} --configuration Release
      
    - name: Test
      run: dotnet test Strawhenge.Builder
        
 
